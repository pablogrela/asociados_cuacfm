<!DOCTYPE html>
<html 
xmlns:th="http://www.thymeleaf.org" 
xmlns:tiles="http://www.thymeleaf.org"
xmlns:sec="http://www.thymeleaf.org/thymeleaf-extras-springsecurity3">
<head>
<title th:text="#{trainingList.title}"></title>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<link rel="shortcut icon" th:href="@{/resources/images/favicon.ico}" />
<link rel="stylesheet" type="text/css" href="//cdn.datatables.net/plug-ins/f2c75b7247b/integration/bootstrap/3/dataTables.bootstrap.css"/>
<link href="../../../resources/css/bootstrap.css" rel="stylesheet" th:href="@{/resources/css/bootstrap.css}" />
<link href="../../../resources/css/core.css" rel="stylesheet" th:href="@{/resources/css/core.css}" />
<script src="//code.jquery.com/jquery-2.1.3.min.js"></script>
<script src="../../../resources/js/bootstrap.min.js" th:src="@{/resources/js/bootstrap.min.js}"></script>
<script src="//cdn.datatables.net/1.10.5/js/jquery.dataTables.min.js"></script>
<script src="//cdn.datatables.net/plug-ins/f2c75b7247b/integration/bootstrap/3/dataTables.bootstrap.min.js"></script>
<script src="../../../resources/js/chargeTable.js" th:src="@{/resources/js/chargeTable.js}"></script>
</head>
<body>

	<!-- Generic Header -->
	<div th:replace="fragments/header :: header(active='training')">&nbsp;</div>

	<!-- Div of buttons -->
	<div class="container text-center containerColums">

		<!-- Form for droplist -->
		<div class="columLeft">
			<form method="post" th:action="@{trainingList/trainingLoad}" th:object="${trainingSelectForm}"
				sec:authorize="hasAnyRole('ROLE_TRAINER , ROLE_ADMIN')">

				<!-- DropList Box -->

				<select onchange="this.form.submit()" class="btn btn-success btn-lg" id="trainingTypeId"
					name="trainingTypeId" th:field="*{trainingTypeId}">

					<!-- Default option in droplist -->
					<option th:value="0" th:text="#{trainingType.createNewTraining}">Create New Training</option>

					<!-- Selected option in droplist -->
					<option th:field="*{trainingTypeId}"
						th:each="trainingType : ${trainingSelectForm.trainingTypes}" th:value="${trainingType.id}"
						th:text="${trainingType.name}">name</option>
				</select> <br></br>

				<!-- Button Create New Training Type -->
				<!--
			<div class="text-center">
				<button type="submit" class="btn btn-success btn-lg"
					th:text="#{training.createNewTraining}">Create New
					Training</button>
			</div>
			<br></br>
			-->
			</form>
		</div>

		<!-- Button redirect to Training List Close-->
		<div class="columRight" sec:authorize="hasAnyRole('ROLE_TRAINER , ROLE_ADMIN')">
			<a class="btn btn-info btn-lg" th:href="@{/trainingList/trainingCloseList}"
				th:text="#{training.viewTrainingClose}">View Training Close</a>
		</div>
	</div>



	<fieldset>

		<!-- Verify if exits Trainings -->
		<div class="container" th:unless="${#lists.isEmpty(trainings)}">

			<!-- Tittle -->
			<h2 class="text-center" th:text="#{training.traininglist}">List of Trainings</h2>


			<!-- Message Info -->
			<div class="container text-center ">
				<!-- /* Handle the flash message */-->
				<th:block th:if="${message != null}">
					<!-- /* The message code is returned from the @Controller */ -->
					<div
						th:replace="fragments/alert :: alert (type=${#strings.toLowerCase(message.type)}, 
						message=#{${message.message}(${message.args[0]})})">&nbsp;</div>
				</th:block>
			</div>


			<!-- Table List of Trainings -->
			<table class="table table-striped table-hover table-responsive" id="customTable">
				<thead class="table-bordered">
					<tr>
						<th th:text="#{name}">Name</th>
						<th th:text="#{training.dateLimit}">Date Limit</th>
						<th th:text="#{training.dateTraining}">Date Training</th>
						<th th:text="#{training.countPlaces}">Place</th>
						<th th:text="#{training.maxPlaces}">Place</th>
						<th th:text="#{close}">Close</th>
						<th class="no-sort"></th>
						<th class="no-sort"></th>
						<th:block sec:authorize="hasAnyRole('ROLE_TRAINER , ROLE_ADMIN')">
							<th class="no-sort"></th>
							<th class="no-sort"></th>
						</th:block>
					</tr>
				</thead>
				<tbody class="table-bordered">

					<tr th:each="training : ${trainings}">

						<td th:text="${training.name}">name</td>
						<td th:text="${{training.dateLimit}}">13/01/2015</td>
						<td th:text="${{training.dateTraining}}">15/01/2015</td>
						<td th:text="${training.countPlaces}">countPlaces</td>
						<td th:text="${training.maxPlaces}">maxPlaces</td>
						<td><input type="checkbox" th:checked="${training.close}"
							th:title="#{training.infoShowClose}" onClick="return false" /></td>

						<!-- View info of training -->
						<td class="text-center">
							<form th:action="@{'trainingList/trainingView/'+${training.id}}" method="post">
								<button class="btnTable btn-link glyphicon glyphicon-search" th:title="#{info}"
									style="color: blue"></button>
							</form>
						</td>


						<!-- Only Admin or Trainer -->
						<th:block sec:authorize="hasAnyRole('ROLE_TRAINER , ROLE_ADMIN')">
							<!-- Delete Training -->
							<td class="text-center">
								<form th:action="@{'trainingList/trainingDelete/'+${training.id}}" method="post">
									<button class="btnTable btn-link glyphicon glyphicon-remove" th:title="#{remove}"
										style="color: red"></button>
								</form>
							</td>

							<!-- Modify Training -->
							<td class="text-center">
								<form th:action="@{'trainingList/trainingEdit/'+${training.id}}" method="post">
									<button role="tooltip" class="btnTable btn-link glyphicon glyphicon-edit" data-toggle="popover"
										th:title="#{edit}" style="color: orange"></button>
								</form>
							</td>

							<!-- View Inscriptions -->
							<td class="text-center">
								<form th:action="@{'trainingList/inscriptionList/'+${training.id}}" method="post">
									<button class="btnTable btn-link glyphicon glyphicon-user"
										th:title="#{training.infoInscriptions}" style="color: green"></button>
								</form>
							</td>
						</th:block>
						<!-- finish -->


						<!-- Only Users -->
						<th:block sec:authorize="hasRole('ROLE_USER')">

							<th:block th:if="!${#lists.contains(trainingUnsubscribeIds, training.id)}">
								<!-- Join Training -->
								<td th:if="!${#lists.contains(trainingAccountIds, training.id)}" class="text-center">
									<form th:action="@{'trainingList/trainingJoin/'+${training.id}}" method="post">
										<button class="btnTable btn-link glyphicon glyphicon-ok-sign" th:title="#{training.join}"
											style="color: green"></button>
									</form>
								</td>


								<!-- Remove Join Training -->
								<td th:if="${#lists.contains(trainingAccountIds, training.id)}" class="text-center">
									<form th:action="@{'trainingList/trainingRemoveJoin/'+${training.id}}" method="post">
										<button class="btnTable btn-link glyphicon glyphicon-remove-sign"
											th:title="#{training.removeJoin}" style="color: red"></button>
									</form>
								</td>
							</th:block>

							<!-- Fill table entry -->
							<td th:if="${#lists.contains(trainingUnsubscribeIds, training.id)}"></td>
						</th:block>
						<!-- Only Users finish -->

					</tr>
				</tbody>
			</table>
		</div>

	</fieldset>
</body>
</html>